#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh" 2>/dev/null || true

# SÃ³ roda se houver arquivos staged dentro de web/
if ! git diff --cached --name-only | grep -q '^web/'; then
  exit 0
fi

echo "ğŸ” Executando lint-staged em web/ ..."
cd "web"

# Preferir o binÃ¡rio local do projeto, assim nÃ£o dependemos de pnpm/yarn na raiz
if [ -x "./node_modules/.bin/lint-staged" ]; then
  node ./node_modules/.bin/lint-staged
else
  echo "â„¹ï¸ ./node_modules/.bin/lint-staged nÃ£o encontrado. Tentando npx (fallback)..."
  npx --yes lint-staged || {
    echo "âŒ lint-staged nÃ£o encontrado. Rode 'pnpm i' ou 'npm i' dentro de web/";
    exit 1
  }
fi
